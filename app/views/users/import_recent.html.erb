<h1><%= "#{@user.name}" %>'s recent media</h1>

<%= render partial: "/photos/add_photo", collection: @photos, as: "photo" %>

<script>

  $("input[type=submit]").click(function(event){
    var user_id, image_url, latitude, longitude, url, type, data;
    event.preventDefault();

    $submit = $(this);
    $form = $submit.parent();
    user_id = $form.find("input#user_id")[0].value;
    image_url = $form.parent().find("input#image_url")[0].value;
    longitude = $form.parent().find("input#longitude")[0].value;
    latitude = $form.parent().find("input#latitude")[0].value;
    url = "/users/" + user_id + "/photos"
    type = "post"
    data = {
      photo: {
        user_id: user_id,
        image_url: image_url,
        longitude: longitude,
        latitude: latitude
      }
    };

    $.ajax({
      url: url,
      type: type,
      data: data
    }).done(function(data, status, jqxhr) {
      $submit[0].value = "Submitted";
    });
  });
</script>